{"ast":null,"code":"import _defineProperty from\"/Users/desireebradish/news-explorer-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/Users/desireebradish/news-explorer-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _toConsumableArray from\"/Users/desireebradish/news-explorer-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/Users/desireebradish/news-explorer-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useCallback}from'react';import{Route,Switch,useLocation,useHistory}from'react-router-dom';import Header from'../Header/Header';import Main from'../Main/Main';import SavedNews from'../SavedNews/SavedNews';import LoginPopup from'../LoginPopup/LoginPopup';import ConfirmationPopup from'../ConfirmationPopup/ConfirmationPopup';import RegisterPopup from'../RegisterPopup/RegisterPopup';import Footer from'../Footer/Footer';import'./App.css';import{mainApi}from'../../utils/MainApi';import{newsApi}from'../../utils/NewsAPI';import CurrentUserContext from\"../../contexts/CurrentUserContext\";import ProtectedRoute from\"../ProtectedRoute/ProtectedRoute\";import{token}from'../../utils/constants';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function App(){/* State Variables */var _useState=useState(false),_useState2=_slicedToArray(_useState,2),Loggedin=_useState2[0],setLoggedin=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isRegisterPopupOpen=_useState4[0],setRegisterPopupOpen=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isLoginPopupOpen=_useState6[0],setLoginPopupOpen=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),isConfirmationPopupOpen=_useState8[0],setConfirmationPopupOpen=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),isMobile=_useState10[0],setIsMobile=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),isMobileNavOpen=_useState12[0],setMobileNavOpen=_useState12[1];var _React$useState=React.useState(window.innerWidth),_React$useState2=_slicedToArray(_React$useState,2),screenWidth=_React$useState2[0],setScreenWidth=_React$useState2[1];var _React$useState3=React.useState({}),_React$useState4=_slicedToArray(_React$useState3,2),currentUser=_React$useState4[0],setCurrentUser=_React$useState4[1];var _React$useState5=React.useState(false),_React$useState6=_slicedToArray(_React$useState5,2),wrongEmailOrPasswordMessage=_React$useState6[0],setWrongEmailOrPasswordMessage=_React$useState6[1];var location=useLocation();var history=useHistory();var savedNewsLocation=location.pathname==='/saved-news';var _React$useState7=React.useState({email:'',password:'',name:''}),_React$useState8=_slicedToArray(_React$useState7,2),values=_React$useState8[0],setValues=_React$useState8[1];var _React$useState9=React.useState({}),_React$useState10=_slicedToArray(_React$useState9,2),errors=_React$useState10[0],setErrors=_React$useState10[1];var _React$useState11=React.useState(false),_React$useState12=_slicedToArray(_React$useState11,2),isValid=_React$useState12[0],setIsValid=_React$useState12[1];var _React$useState13=React.useState(false),_React$useState14=_slicedToArray(_React$useState13,2),duplicateEmail=_React$useState14[0],setDuplicateEmail=_React$useState14[1];var _React$useState15=React.useState(false),_React$useState16=_slicedToArray(_React$useState15,2),preloader=_React$useState16[0],setPreloader=_React$useState16[1];var _useState13=useState(''),_useState14=_slicedToArray(_useState13,2),searchTerm=_useState14[0],setSearchTerm=_useState14[1];var _useState15=useState(''),_useState16=_slicedToArray(_useState15,2),searchErrorMsg=_useState16[0],setSearchErrorMsg=_useState16[1];var _useState17=useState(false),_useState18=_slicedToArray(_useState17,2),notFound=_useState18[0],setNotFound=_useState18[1];var _useState19=useState(false),_useState20=_slicedToArray(_useState19,2),results=_useState20[0],setResults=_useState20[1];var _React$useState17=React.useState([]),_React$useState18=_slicedToArray(_React$useState17,2),cards=_React$useState18[0],setCards=_React$useState18[1];var _useState21=useState(3),_useState22=_slicedToArray(_useState21,2),numCardsShown=_useState22[0],setNumCardsShown=_useState22[1];var _React$useState19=React.useState([]),_React$useState20=_slicedToArray(_React$useState19,2),savedCards=_React$useState20[0],setSavedCards=_React$useState20[1];console.log(\"errors are \"+errors);// Use Effects\nReact.useEffect(function(){handleCheckToken();},[]);//Get Username and such\nReact.useEffect(function(){if(localStorage.getItem(\"token\")){getUser();}},[]);React.useEffect(function(){var handleScreenSizeChange=function handleScreenSizeChange(){return setScreenWidth(window.innerWidth);};window.addEventListener(\"resize\",handleScreenSizeChange);setIsMobile(screenWidth<768);return function(){return window.removeEventListener(\"resize\",handleScreenSizeChange);};},[screenWidth]);//Get Saved Cards and put them on the server\nReact.useEffect(function(){if(localStorage.getItem('savedCards')!==null&&Loggedin){setSavedCards(JSON.parse(localStorage.getItem('savedCards')));setResults(true);}},[]);//Article Stuff\nfunction _handleDeleteArticle(article){article.isSaved=false;mainApi.deleteArticle(article._id).then(function(){var newSavedCards=savedCards.filter(function(c){return c._id!==article._id;});setSavedCards(newSavedCards);var newCards=cards.map(function(c){return c._id===article._id?article:c;});setCards(newCards);localStorage.setItem('savedCards',JSON.stringify(newSavedCards));}).catch(function(err){return console.log(\"Error: \"+err);});}function findSavedArticles(token){mainApi.getArticles(token).then(function(res){setSavedCards(res);}).catch(function(error){return console.log(error);});}function _handleSaveArticle(card){if(!Loggedin){return handleSigninClick();}else if(card.isSaved===true){_handleDeleteArticle(card);}else if(!savedNewsLocation&&Loggedin){card.keyword=searchTerm;card.source=card.source.name;mainApi.saveArticle(card).then(function(newCard){newCard.isSaved=true;var newCards=cards.map(function(c){return c===card?newCard:c;});var newSavedCards=[].concat(_toConsumableArray(savedCards),[newCard]);setSavedCards(newSavedCards);setCards(newCards);localStorage.setItem('savedCards',JSON.stringify(newSavedCards));}).catch(function(err){return console.log(\"Error: \"+err);});}else{_handleDeleteArticle(card);}}//SignIn / Singup Stuff (Minus Click Events)\nfunction handleCheckToken(){var jwt=localStorage.getItem(\"token\");if(jwt){mainApi.checkToken(jwt).then(function(res){if(res){setLoggedin(true);setValues({email:res.email,password:res.password,name:res.name});history.push('/');}}).catch(function(err){console.log(\"Err: \"+err);});}}function handleSignup(e){e.preventDefault();console.log(\"These Values are correct heading to the mainApi\"+values.name);mainApi.register(values.email,values.password,values.name).then(function(res){if(res.message==='Duplicate User'){setDuplicateEmail(true);return Promise.reject(\"Error! \".concat(res.message));}if(res.ok){return res.json();}}).then(function(){setConfirmationPopupOpen(true);setRegisterPopupOpen(false);setDuplicateEmail(false);resetForm();}).catch(function(err){return console.log(err);});}function handleSignIn(e){if(e){e.preventDefault();}e.preventDefault();mainApi.authorize(values.email,values.password).then(function(res){if(res.statusCode===400){setWrongEmailOrPasswordMessage(true);return Promise.reject(\"Error! \".concat(res.message));}console.log(res);localStorage.setItem('token',res.token);console.log(localStorage.getItem('token'));getUser();}).then(function(){handleCheckToken();closeAllPopups();resetForm();window.location.reload();}).catch(function(res){if(res.statusCode===400){console.log('one of the fields was filled in incorrectly');setWrongEmailOrPasswordMessage(true);return Promise.reject(\"Error! \".concat(res.message));}if(res.statusCode===401){console.log('user email not found');setWrongEmailOrPasswordMessage(true);return Promise.reject(\"Error! \".concat(res.message));}});}function handleSignOut(e){e.preventDefault();localStorage.removeItem('token');setLoggedin(false);history.push('/');closeAllPopups();window.location.reload();}//More User Stuff\nfunction getUser(){mainApi.getUserInfo().then(function(res){setCurrentUser(res);findSavedArticles(token);}).catch(function(err){console.log(err);});}//Form Stuff\nfunction fieldValidation(){var validEmailRegex=RegExp(/^\\w+([.-]?\\w+)*@\\w+([.-]?\\w+)*(\\.\\w{2,3})+$/i);setErrors(function(origErrors){return _objectSpread(_objectSpread({},origErrors),{},{email:validEmailRegex.test(values.email)?\"\":\"Invalid email address\"});});}var handleChangeForm=function handleChangeForm(e){var _e$target=e.target,name=_e$target.name,value=_e$target.value;var newValues=_objectSpread(_objectSpread({},values),{},_defineProperty({},name,value));console.log(newValues);setValues(newValues);fieldValidation(newValues);setErrors(_objectSpread(_objectSpread({},errors),{},_defineProperty({},name,errors[name])));setWrongEmailOrPasswordMessage(false);setIsValid(e.target.closest('form').checkValidity());};var resetForm=useCallback(function(){var newValues=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{email:'',password:'',name:''};var newErrors=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{email:'',password:'',name:''};var newIsValid=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;setValues(newValues);setErrors(newErrors);setIsValid(newIsValid);},[setValues,setErrors,setIsValid]);function handleShowMore(){setNumCardsShown(numCardsShown+3);}//Search Stuff\nfunction handleSearchSubmit(e){e.preventDefault();setPreloader(true);if(searchTerm.length===0){setPreloader(false);setSearchErrorMsg('Must enter search term');return;}newsApi.getNewsCards(searchTerm).then(function(data){if(data.length===0){setNotFound(true);}return data;}).then(function(cards){setNumCardsShown(3);setCards(cards);setResults(true);setSearchTerm(searchTerm);setPreloader(false);setSearchErrorMsg('');}).catch(function(){setSearchErrorMsg(\"Something went wrong with this request. Please try again later.\");setPreloader(false);});}//Popups\nfunction closeAllPopups(){setLoginPopupOpen(false);setRegisterPopupOpen(false);setMobileNavOpen(false);setConfirmationPopupOpen(false);}function handleMobileClick(){setMobileNavOpen(true);}function handleMobileClose(){setMobileNavOpen(false);}//Click Events\nfunction handleSigninClick(){setLoginPopupOpen(true);setRegisterPopupOpen(false);setMobileNavOpen(false);setConfirmationPopupOpen(false);}function handleRegisterLinkClick(){setRegisterPopupOpen(true);setLoginPopupOpen(false);setWrongEmailOrPasswordMessage(false);}return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"div\",{className:\"page\",children:/*#__PURE__*/_jsxs(CurrentUserContext.Provider,{value:currentUser,children:[/*#__PURE__*/_jsx(Header,{values:values,Loggedin:Loggedin,savedNewsLocation:savedNewsLocation,onSigninClick:handleSigninClick,onSignOut:handleSignOut,mobile:isMobile,mobileNavOpen:isMobileNavOpen,onHamburgerClick:handleMobileClick,onClose:handleMobileClose}),/*#__PURE__*/_jsxs(Switch,{children:[/*#__PURE__*/_jsx(ProtectedRoute,{exact:true,path:\"/saved-news\",component:SavedNews,Loggedin:Loggedin,cards:cards,searchTerm:searchTerm,savedCards:savedCards,savedNewsLocation:savedNewsLocation,currentUser:currentUser,handleSigninClick:handleSigninClick,handleSaveArticle:function handleSaveArticle(card){_handleSaveArticle(card);},handleDeleteArticle:function handleDeleteArticle(card){_handleDeleteArticle(card);}}),/*#__PURE__*/_jsx(Route,{path:\"/\",children:/*#__PURE__*/_jsx(Main,{setSearchTerm:setSearchTerm,Loggedin:Loggedin,savedNewsLocation:savedNewsLocation,handleSearchSubmit:handleSearchSubmit,setSearchErrorMsg:setSearchErrorMsg,searchErrorMsg:searchErrorMsg,searchTerm:searchTerm,preloader:preloader,notFound:notFound,results:results,cards:cards,handleShowMore:handleShowMore,handleSave:true,numCardsShown:numCardsShown,handleSaveArticle:function handleSaveArticle(card){_handleSaveArticle(card);},currentUser:currentUser})})]}),/*#__PURE__*/_jsx(Footer,{}),/*#__PURE__*/_jsx(LoginPopup,{onSignupClick:handleRegisterLinkClick,onClose:closeAllPopups,isOpen:isLoginPopupOpen,onSubmit:handleSignIn,handleChangeForm:handleChangeForm,values:values,isValid:isValid,wrongEmailOrPasswordMessage:wrongEmailOrPasswordMessage}),/*#__PURE__*/_jsx(RegisterPopup,{onSigninClick:handleSigninClick,onClose:closeAllPopups,isOpen:isRegisterPopupOpen,onSubmit:handleSignup,handleChangeForm:handleChangeForm,values:values,duplicateEmail:duplicateEmail,isValid:isValid}),/*#__PURE__*/_jsx(ConfirmationPopup,{onSigninClick:handleSigninClick,onClose:closeAllPopups,isOpen:isConfirmationPopupOpen})]})})});}export default App;","map":{"version":3,"sources":["/Users/desireebradish/news-explorer-frontend/src/components/App/App.js"],"names":["React","useState","useCallback","Route","Switch","useLocation","useHistory","Header","Main","SavedNews","LoginPopup","ConfirmationPopup","RegisterPopup","Footer","mainApi","newsApi","CurrentUserContext","ProtectedRoute","token","App","Loggedin","setLoggedin","isRegisterPopupOpen","setRegisterPopupOpen","isLoginPopupOpen","setLoginPopupOpen","isConfirmationPopupOpen","setConfirmationPopupOpen","isMobile","setIsMobile","isMobileNavOpen","setMobileNavOpen","window","innerWidth","screenWidth","setScreenWidth","currentUser","setCurrentUser","wrongEmailOrPasswordMessage","setWrongEmailOrPasswordMessage","location","history","savedNewsLocation","pathname","email","password","name","values","setValues","errors","setErrors","isValid","setIsValid","duplicateEmail","setDuplicateEmail","preloader","setPreloader","searchTerm","setSearchTerm","searchErrorMsg","setSearchErrorMsg","notFound","setNotFound","results","setResults","cards","setCards","numCardsShown","setNumCardsShown","savedCards","setSavedCards","console","log","useEffect","handleCheckToken","localStorage","getItem","getUser","handleScreenSizeChange","addEventListener","removeEventListener","JSON","parse","handleDeleteArticle","article","isSaved","deleteArticle","_id","then","newSavedCards","filter","c","newCards","map","setItem","stringify","catch","err","findSavedArticles","getArticles","res","error","handleSaveArticle","card","handleSigninClick","keyword","source","saveArticle","newCard","jwt","checkToken","push","handleSignup","e","preventDefault","register","message","Promise","reject","ok","json","resetForm","handleSignIn","authorize","statusCode","closeAllPopups","reload","handleSignOut","removeItem","getUserInfo","fieldValidation","validEmailRegex","RegExp","origErrors","test","handleChangeForm","target","value","newValues","closest","checkValidity","newErrors","newIsValid","handleShowMore","handleSearchSubmit","length","getNewsCards","data","handleMobileClick","handleMobileClose","handleRegisterLinkClick"],"mappings":"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","sourcesContent":["import React, { useState, useCallback } from 'react';\nimport { Route, Switch, useLocation, useHistory} from 'react-router-dom';\nimport Header from '../Header/Header';\nimport Main from '../Main/Main';\nimport SavedNews from '../SavedNews/SavedNews';\nimport LoginPopup from '../LoginPopup/LoginPopup';\nimport ConfirmationPopup from '../ConfirmationPopup/ConfirmationPopup';\nimport RegisterPopup from '../RegisterPopup/RegisterPopup';\nimport Footer from '../Footer/Footer';\nimport './App.css'; \nimport { mainApi } from '../../utils/MainApi';\nimport { newsApi } from '../../utils/NewsAPI';\nimport CurrentUserContext from \"../../contexts/CurrentUserContext\";\nimport ProtectedRoute from \"../ProtectedRoute/ProtectedRoute\";\nimport { token } from '../../utils/constants'\n\n function App() {\n /* State Variables */\n  const [Loggedin, setLoggedin] = useState(false);\n  const [isRegisterPopupOpen, setRegisterPopupOpen] = useState(false);\n  const [isLoginPopupOpen, setLoginPopupOpen] = useState(false);\n  const [isConfirmationPopupOpen, setConfirmationPopupOpen] = useState(false);\n  const [isMobile, setIsMobile] = useState(false);\n  const [isMobileNavOpen, setMobileNavOpen] = useState(false);\n  const [screenWidth, setScreenWidth] = React.useState(window.innerWidth);\n  const [currentUser, setCurrentUser] = React.useState({});\n  const [wrongEmailOrPasswordMessage, setWrongEmailOrPasswordMessage] = React.useState(false)\n  const location = useLocation();\n  const history= useHistory();\n const savedNewsLocation = location.pathname === '/saved-news';\nconst [values, setValues] = React.useState({ email: '', password: '', name: '' });\n\n  const [errors, setErrors] = React.useState({});\n  const [isValid, setIsValid] = React.useState(false);\n  const [duplicateEmail, setDuplicateEmail] = React.useState(false);\n  const [preloader, setPreloader] = React.useState(false);\n\nconst [searchTerm, setSearchTerm] = useState('');\nconst [searchErrorMsg, setSearchErrorMsg] = useState('');\nconst[notFound, setNotFound] = useState(false)\n\n  const [results, setResults] = useState(false);\n  const [cards, setCards] = React.useState([]);\n  const [numCardsShown, setNumCardsShown] = useState(3);\n  const [savedCards, setSavedCards] = React.useState([]);\nconsole.log(\"errors are \" + errors)\n// Use Effects\n\n  React.useEffect(() => {\n    handleCheckToken();\n  }, []);\n\n//Get Username and such\n React.useEffect(() => {\n    if (localStorage.getItem(\"token\")) {\n      getUser();\n    }\n  }, []);\n\n    React.useEffect(() => {\n    const handleScreenSizeChange = () => setScreenWidth(window.innerWidth);\n    window.addEventListener(\"resize\", handleScreenSizeChange);\n\nsetIsMobile(screenWidth < 768);\n\n    return () => window.removeEventListener(\"resize\", handleScreenSizeChange);\n  }, [screenWidth]);\n\n\n//Get Saved Cards and put them on the server\n  React.useEffect(() => {\n\n    if (localStorage.getItem('savedCards') !== null && Loggedin) {\n      setSavedCards(JSON.parse(localStorage.getItem('savedCards')));\n      setResults(true);\n    }\n  }, []);\n\n\n//Article Stuff\nfunction handleDeleteArticle(article) {\n    article.isSaved = false;\n    mainApi.deleteArticle(article._id)\n      .then(() => {\n        const newSavedCards = savedCards.filter((c) => c._id !== article._id);\n        setSavedCards(newSavedCards);\n        \n        const newCards = cards.map((c) => (c._id === article._id ? article : c));\n        setCards(newCards);\n        localStorage.setItem('savedCards', JSON.stringify(newSavedCards));\n        \n      })\n      .catch(err => console.log(\"Error: \" + err));\n  }\n\n \n function findSavedArticles(token) {\n    mainApi\n      .getArticles(token)\n      .then((res) => {\n        setSavedCards(res);\n      })\n      .catch((error) => console.log(error));\n  }\n\n\n    function handleSaveArticle(card) {\n    if (!Loggedin) {\n      return handleSigninClick();\n    } else if (card.isSaved === true) {\n     handleDeleteArticle(card);\n    }\n    else if (!savedNewsLocation && Loggedin) {\n      card.keyword = searchTerm;\n      card.source = card.source.name;\n      mainApi.saveArticle(card)\n        .then((newCard) => {\n          newCard.isSaved = true;\n          const newCards = cards.map((c) => c === card ? newCard : c);\n\n          const newSavedCards = [...savedCards, newCard];\n          setSavedCards(newSavedCards);\n          setCards(newCards);\n          localStorage.setItem('savedCards', JSON.stringify(newSavedCards));\n        })\n        .catch(err => console.log(\"Error: \" + err));\n\n    }\n    else {\n      handleDeleteArticle(card);\n    }\n  }\n\n\n//SignIn / Singup Stuff (Minus Click Events)\n\nfunction handleCheckToken() {\n  const jwt = localStorage.getItem(\"token\");\n  if (jwt) {\n      mainApi\n        .checkToken(jwt)\n        .then(res => {\n          if (res) {\n            setLoggedin(true);\n            setValues({ email: res.email, password: res.password, name: res.name });\n            history.push('/')\n          }\n        })\n        .catch(err => {\n          console.log(\"Err: \" + err);\n        });\n    }\n  \n  }\n\n\n  function handleSignup(e){ \n    e.preventDefault();\n    console.log(\"These Values are correct heading to the mainApi\" + values.name)\n    mainApi.register(values.email, values.password, values.name)\n    .then((res) =>{\n       if (res.message === 'Duplicate User') {      \n         setDuplicateEmail(true)    \n          return Promise.reject(`Error! ${res.message}`);\n        }\n        if (res.ok){\n      return res.json();\n        }\n    })\n    .then(() => {\n        setConfirmationPopupOpen(true);\n        setRegisterPopupOpen(false);\n        setDuplicateEmail(false)       \n        resetForm();\n      })\n      .catch(err => console.log(err));\n  }\n\n\n  function handleSignIn(e) {    \n    if (e){\n    e.preventDefault();\n    }\n    e.preventDefault();\n    mainApi\n      .authorize(values.email, values.password)\n      .then(res => {\n   \n        if (res.statusCode === 400) {\n          setWrongEmailOrPasswordMessage(true);\n          return Promise.reject(`Error! ${res.message}`);\n        }\n        console.log(res)\n        localStorage.setItem('token', res.token);\n        console.log(localStorage.getItem('token'));\n        getUser();\n      })\n      .then(() => {\n         handleCheckToken();\n        closeAllPopups();\n        resetForm();\n       \n        window.location.reload();\n      })\n      .catch(res => {\n        if (res.statusCode === 400) {\n          console.log('one of the fields was filled in incorrectly')\n           setWrongEmailOrPasswordMessage(true);\n          return Promise.reject(`Error! ${res.message}`);\n        }\n        if (res.statusCode === 401) {\n          console.log('user email not found')\n           setWrongEmailOrPasswordMessage(true);\n          return Promise.reject(`Error! ${res.message}`);\n        }\n      })\n  \n\n  }\n\n\n   function handleSignOut(e) {\n    e.preventDefault();\n    localStorage.removeItem('token');\n    setLoggedin(false);   \n    history.push('/');\n    closeAllPopups();   \n    window.location.reload();\n  }\n\n\n//More User Stuff\n\n  function getUser() {\n    mainApi\n      .getUserInfo()\n      .then((res) => {\n        setCurrentUser(res);\n        \n        findSavedArticles(token);\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n  }\n\n  //Form Stuff\n function fieldValidation() {\n    const validEmailRegex = RegExp(\n      /^\\w+([.-]?\\w+)*@\\w+([.-]?\\w+)*(\\.\\w{2,3})+$/i\n    );\n    setErrors((origErrors) => ({\n      ...origErrors,\n      email: validEmailRegex.test(values.email) ? \"\" : \"Invalid email address\",\n    }));\n\n  }\n\n   \n\n  const handleChangeForm = (e) => {\n   const { name, value } = e.target;\n    const newValues = {\n      ...values,\n      [name]: value,\n    };\n    console.log(newValues)\n    setValues(newValues);\n    fieldValidation(newValues);\n    setErrors({ ...errors, [name]: errors[name] });\n    setWrongEmailOrPasswordMessage(false);\n    setIsValid(e.target.closest('form').checkValidity());\n  };\n\n  const resetForm = useCallback(\n    (\n      newValues = { email: '', password: '', name: '' },\n      newErrors = { email: '', password: '', name: '' },\n      newIsValid = false,\n    ) => {\n      setValues(newValues);\n      setErrors(newErrors);\n      setIsValid(newIsValid);\n    },\n    [setValues, setErrors, setIsValid],\n  );\nfunction handleShowMore(){\n  setNumCardsShown(numCardsShown + 3);\n}\n\n\n\n\n//Search Stuff\n\nfunction handleSearchSubmit(e) {\n    e.preventDefault();\n    setPreloader(true);\n    if (searchTerm.length === 0) {\n      setPreloader(false);\n      setSearchErrorMsg('Must enter search term');\n      return\n    }\n    newsApi.getNewsCards(searchTerm)\n      .then((data) => {\n        if (data.length === 0) {\n          setNotFound(true);\n        }\n        return data;\n      })\n      .then((cards) => {\n        setNumCardsShown(3);\n        setCards(cards);\n        setResults(true);\n        setSearchTerm(searchTerm);\n        setPreloader(false);\n        setSearchErrorMsg('');\n\n      })\n      .catch(() => {\n        setSearchErrorMsg(\"Something went wrong with this request. Please try again later.\")\n        setPreloader(false);\n      })\n\n    }\n\n//Popups\nfunction closeAllPopups() {    \n    setLoginPopupOpen(false);\n    setRegisterPopupOpen(false);\n    setMobileNavOpen(false);\n    setConfirmationPopupOpen(false);\n  }\n  function handleMobileClick() {\n    setMobileNavOpen(true);\n  }\n\nfunction handleMobileClose() {\n    setMobileNavOpen(false);\n    }\n//Click Events\n\n\nfunction handleSigninClick() {    \n    setLoginPopupOpen(true);\n    setRegisterPopupOpen(false);\n    setMobileNavOpen(false);\n    setConfirmationPopupOpen(false);\n  }\nfunction handleRegisterLinkClick() {\n    setRegisterPopupOpen(true);\n    setLoginPopupOpen(false);\n    setWrongEmailOrPasswordMessage(false);\n  }\n\n  \n\n\n\n  return (\n     <>\n      <div className=\"page\">\n         <CurrentUserContext.Provider value={currentUser}>\n       <Header \n       values={values}\n       Loggedin={Loggedin}\n       savedNewsLocation={savedNewsLocation}\n       onSigninClick={handleSigninClick}\n       onSignOut={handleSignOut}\n       mobile={isMobile}\n       mobileNavOpen={isMobileNavOpen}\n       onHamburgerClick={handleMobileClick}\n       onClose={handleMobileClose}\n       />\n\n         <Switch> \n           <ProtectedRoute\n              exact path='/saved-news'\n              component={SavedNews}\n              Loggedin={Loggedin}\n              cards={cards}\n              searchTerm={searchTerm}\n              savedCards={savedCards}\n              savedNewsLocation={savedNewsLocation}\n              currentUser={currentUser}\n              handleSigninClick={handleSigninClick}\n              handleSaveArticle={(card) => { handleSaveArticle(card) }}\n              handleDeleteArticle={(card) => { handleDeleteArticle(card) }}\n            />\n          <Route path='/'>\n            <Main\n            setSearchTerm={setSearchTerm}\n            Loggedin={Loggedin}\n            savedNewsLocation={savedNewsLocation}\n            handleSearchSubmit={handleSearchSubmit}\n            setSearchErrorMsg={setSearchErrorMsg}\n            searchErrorMsg={searchErrorMsg}\n                searchTerm={searchTerm}\n                preloader={preloader}\n                notFound={notFound}\n                results={results}\n                cards={cards}\n                handleShowMore={handleShowMore}handleSave\n                numCardsShown={numCardsShown}\n                 handleSaveArticle={(card) => { handleSaveArticle(card) }}\n            \n            currentUser={currentUser}\n            \n            />\n          </Route>\n            \n        </Switch>\n\n\n       <Footer />\n       <LoginPopup\n          onSignupClick={handleRegisterLinkClick}\n          onClose={closeAllPopups}\n          isOpen={isLoginPopupOpen}\n          onSubmit={handleSignIn}\n          handleChangeForm={handleChangeForm}\n          values={values}\n          isValid={isValid}\n          wrongEmailOrPasswordMessage={wrongEmailOrPasswordMessage}\n        />\n        <RegisterPopup\n          onSigninClick={handleSigninClick}\n          onClose={closeAllPopups}\n          isOpen={isRegisterPopupOpen}\n          onSubmit={handleSignup}\n          handleChangeForm={handleChangeForm}\n          values={values}\n          duplicateEmail={duplicateEmail}\n           isValid={isValid}\n        />\n        <ConfirmationPopup\n        onSigninClick={handleSigninClick}\n        onClose={closeAllPopups}\n        isOpen={isConfirmationPopupOpen}\n        />\n        </CurrentUserContext.Provider>\n       </div>\n     </>\n   );\n }\n\nexport default App;\n\n"]},"metadata":{},"sourceType":"module"}